---
title: Arch Linux
layout: dep
date: 2016-01-13
---


* ArchLinux 64bit with EFI のインストールの手順です。
* デザイン性が高く、軽い UI を構築します。
* `/home` パーティションを切り離し移植性を高めます。


# make install media

~~~
## @ osx
hdiutil convert -format UDRW -o archlinux.img archlinux.iso
mv archlinux.img.dmg archlinux.img
diskutil list

## see the destination usb device
sudo dd if=archlinux.img of=/dev/diskXXX bs=1m
~~~

# boot usb

1. insert usb
2. join BIOS setting
3. turn off UEFI mode
4. reboot
5. choose `64 bit` Boot Arch Linux

# Design partitioning !

***************************************
*                                     *
*                                     *
*   .---+------.            +-----+   *
*  |sda1| /boot |           |/boot|   *
*  +----+-------+           |sda1 |   *
*  |sda2| swap  |           +-----+   *
*  +----+-------+   +-----+/          *
*  |sda3| /home |   |  /  +           *
*  +----+-------+   |sda4 |\          *
*  |sda4| /     |   +-----+ +-----+   *
*   '---+------'            |/home|   *
*                           |sda3 |   *
*                           '-----+   *
*                                     *
***************************************

# Installation

~~~
## connect to Internet !
wifi-menu

## partition
lsblk
gdisk /dev/sda
# Command : o
# Command : n       >>>       1 >>>         >>>   +512M >>>    ef00
# Command : n       >>>       2 >>>         >>>     +8G >>>    8200 (swap)
# Command : n       >>>       3 >>>         >>>    +64G >>>         (default: 8300)
# Command : n       >>>       4 >>>         >>>         >>>         (default: 8300)
# Command : w
gdisk -l /dev/sda


## Determine file system
mkfs.vfat -F32 /dev/sda1
mkfs.ext4 /dev/sda3
mkfs.ext4 /dev/sda4
mkswap /dev/sda2 && swapon /dev/sda2


## mount
mount /dev/sda4 /mnt
mkdir /mnt/home
mount /dev/sda3 /mnt/home


## if you use GRUM on bios/gpt ,
##      Do not mount /dev/sda1 !!!


## update hardwareclock
timedatectl


## choose mirror
vim /etc/pacman.d/mirrorlist


## install base
pacstrap /mnt base base-devel


## structuring how to mount partitions
genfstab -p /mnt >> /mnt/etc/fstab


## chroot
arch-chroot /mnt


## install tools
pacman -S vim zsh curl wget


## set hostname
echo ghasshee > /etc/hostname


## choose timezone
ln -sf /usr/share/zoneinfo/Asia/Tokyo /etc/localtime


## set locale
vim /etc/locale.gen
#decomment en_US.UTF-8
#decomment ja_JP.UTF-8
#:wq!
locale-gen
echo LANG=en_US.UTF-8 > /etc/locale.conf


## make memory table loader
mkinitcpio -p linux


## set root password
passwd


## install network tools
pacman -S iw wpa_supplicant  //wireless network interface
pacman -S dialog             //wifi-menu is depending on
pacman -S wpa_actiond        //automate wireless connection




## GRUB
pacman -S grub dosfstools efibootmgr
grub-install --target=x86_64-efi --efi-directory=/boot --bootloader-id=arch_grub --recheck --debug
grub-mkconfig -o /boot/grub/grub.cfg


## optional
## in case your machine can run with a specified efi file
## mkdir /boot/EFI/boot
## cp /boot/EFI/arch_grub/grubx64.efi  /boot/EFI/boot/bootx64.efi


## OK, reboot it !
exit && reboot
~~~



# GUI and configurations



~~~
## networks
systemctl enable dhcpcd.service && systemctl start dhcpcd.service
systemctl enable netctl && systemctl start netctl


## create user and login
useradd -m -g wheel ghasshee
pacman -S sudo
visudo
# decomment Defaults env_keep += "HOME"   //set $HOME
# decomment %wheel ALL=(ALL) all
# :wq!
su ghasshee


## install Yaourt package manager !!
sudo echo "[archlinuxfr]" >> /etc/pacman.conf
sudo echo "SigLevel = Never" >> /etc/pacman.conf
sudo echo "Server = http://repo.archlinux.rf/$arch" >> /etc/pacman.conf
sudo pacman -Sy yaourt


## install Xwindow
sudo pacman -S xorg-server xorg-server-utils xorg-xinit xorg-xclock xterm


## install xfce4
sudo pacman -S xfce4 xfce4-goodies gamin


## automate xfce startup
echo "exec startxfce4" >> ~/.xinitrc


# install Graphic Driver
lspci | grep VGA
sudo pacman -Ss nvidia    //find your driver
sudo pacman -S nvidia


## install Fonts
yaourt -S ttf-ricty
yaourt -S otf-takao oft-ipaexfont ttf-ipa-mona


## install Display Manager (Login Manager)
sudo pacman -S slim archlinux-themes-slim slim-themes
sudo vim /etc/slim.conf
# login_cmd exec /usr/bin/zsh -l ~/.xinitrc %session
# daemon yes
# current_theme archlinux-simplyblack
# :wq!
sudo systemctl enable slim.service



## install Japanese
sudo pacman -S fcitx-im fcitx-anthy fcitx-configtool


echo "export GTK_IM_MODULE=fcitx" >> $HOME/.xinitrc
echo "export QT_IM_MODULE=fcitx" >> $HOME/.xinitrc
echo 'export XMODIFIERS="@im=fcitx"' >> $HOME/.xinitrc


## Apperrance
sudo yaourt -S numix-themes numix-circle-icon-theme-git
# reboot
# login ghasshee and
# Application menu > setting > Apperrance
# * style tab : Numix
# * icon tab : Numix Circle
# * font tab : Ricty
# Application menu > setting > windowManager
# * style tab's theme : Numix
# * style tab's title's font : Ricty


## Sound
sudo pacman -S alsa-utils
sudo alsactl store

### usage : open mixer
## $ alsamixer
### note : in case alsactl crash , type:
## $ sudo alsactl init


## GUI for `alsamixer` (optional)
sudo pacman -S pulseaudio
sudo reboot


## Mouse Driver
sudo pacman -S xf86-input-synaptics
sudo pacman -S xf86-input-mouse


## supplement Thunar FileManager
sudo pacman -S thunar-volman thunar-media-tags-plugin thunar-archive-plugin file-roller
exo-preffered-application


## Dropbox with Thunar
yaourt -S thunar-dropbox dropbox


## 外部メディアやディスクの自動マウント
## SMBやFTPをnemo上でダブルクリックすると自動的にマウントしてくるツール
sudo pacman -S gvfs gvfs-afc gvfs-smb gvfs-afp gvfs-gphoto2 gvfs-mtp gvfs-goa


## SMBやFTPに接続する際に入力するユーザー名やパスワードを管理するツール
sudo pacman -S seahorse gnome-keyring


## oh my zsh
curl -L http://install.ohmyz.sh | sh
chsh -s /usr/bin/zsh
~~~

~~~
## etc

* chromium
* atom-editor
* ocular
* tmux
* guake (install & press F12 )
* vlc (play movies)
* ffmpeg
* launchy (command lancher)
* plank (App Dock like OSX)
* python-pip
* htop
* screenfetch (echo "screenfetch" >> .zshrc)
~~~
