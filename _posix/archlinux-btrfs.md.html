---
title: Arch Linux Btrfs
layout: dep
date: 2017-01-06
---



* x  UEFI
* o  BIOS/GPT

# make install media


@ OSX

~~~
$ diskutil list             ## see the destination usb device
$ sudo dd if=archlinux.img of=/dev/diskXXX bs=1m
~~~


# boot usb

1. insert usb
2. join BIOS setting
3. turn off UEFI mode
4. reboot
5. if you are installing on 4G memory laptop ,
  * choose `i686 bit` Boot Arch Linux

# design partitioning !


  ***************************************
  *                                     *
  *   .---+------.            +-----+   *
  *  |sda1| /boot |           |/boot|   *
  *  +----+-------+           |sda1 |   *
  *  |sda2| swap  |   +-----+/+-----+   *
  *  +----+-------+   |sda3 |           *
  *  |sda3| /     |   +-----+           *
  *   '---+------'                      *
  *                                     *
  ***************************************



# installation

~~~
pre_setting(){
    DISK="sdxxx"
    HOSTNAME="ghasshee"

    wifi-menu       ## connect to internet
    lsblk           ## see your deviece
}


partitioning(){
    gdisk /dev/${DISK}
    # Command : o (make new partition table)
    #
    # Command : n     >>>     1 >>>       >>>     +1M >>>    ef02
    # Command : n     >>>     2 >>>       >>>     +8G >>>    8200 (swap)
    # Command : n     >>>     3 >>>       >>>         >>>         (default: 8300)
    # Command : w
    gdisk -l /dev/${DISK}

}


determine_filesystems(){
    mkfs.ext2 /dev/${DISK}1
    mkfs.btrfs /dev/${DISK}3
    mkswap /dev/${DISK}2 && swapon /dev/${DISK}2
}

mount_partitions(){
    mount /dev/${DISK}3 /mnt
}


## if you use GRUB on bios/gpt ,
##      Do not mount /dev/${DISK}1 !!!


update_hardwareclock(){
    timedatectl
}


choose_mirror(){
    vim /etc/pacman.d/mirrolist
}

install_base(){
    pacstrap /mnt base base-devel
}

generate_fstab(){
    genfstab -p /mnt >> /mnt/etc/fstab
}

do_chroot(){
    arch-chroot /mnt /bin/bash
}

set_locale(){
    echo "en_US.UTF-8 UTF-8" >> /etc/locale.gen
    echo "ja_JP.UTF-8 UTF-8" >> /etc/locale.gen
    locale-gen
}

set_language(){
    echo LANG=en_US.UTF-8 > /etc/locale.conf
    export LANG=en_US.UTF-8
}


install_tools(){
    pacman -S vim zsh curl wget
}

set_time(){
    ln -sf /usr/share/zoneinfo/Asia/Tokyo /etc/localtime
    hwclock --systohc --utc
}

set_hosts(){
    echo "# /etc/hosts: static lookup table for host names" > /etc/hosts
    echo "#<ip-address> <hostname .domain.org=""> <hostname>" >> /etc/hosts
    echo "127.0.0.1 localhost.localdomain localhost $HOSTNAME" >> /etc/hosts
    echo "::1  localhost.localdomain localhost $HOSTNAME" >> /etc/hosts

    echo $HOSTNAME > /etc/hostname

}

install_wifi_manager(){
    pacman -S iw wpa_supplicant  ## wireless network interface
    pacman -S dialog             ## wifi-menu is depending on
    pacman -S wpa_actiond        ## automate wireless connection
}

install_network_manager(){
    pacman -S networkmanager xfce4-notifyd gnome-keyring
    systemctl enable NetworkManager
}

###### KERNEL UPGRADE
#### if ( you are upgrading kernel )
#### then
####       pacman -S linux        // this command also creates kernel img in /boot/
#### fi

init_memory_table(){
    mkinitcpio -p linux
}

install_grub(){
    pacman -S grub-bios
    lsblk /dev/${DISK}
    grub-install --recheck /dev/${DISK}
    grub-mkconfig -o /boot/grub/grub.cfg
}

do_exit(){
    exit
}



## install GRUB !


## OK, reboot it !
exit
reboot
~~~



## gui && additionals

~~~



## set root password
passwd


## configure networks
systemctl enable dhcpd.service && systemctl start dhcpd.service
systemctl enable netctl && systemctl start netctl


## create user and login
useradd -m -g wheel ghasshee
pacman -S sudo
visudo
## decomment Defaults env_keep += "HOME"   //set $HOME
## decomment %wheel ALL=(ALL) all
## :wq!
su ghasshee


## install Yaourt package manager !!
sudo echo "[archlinuxfr]" >> /etc/pacman.conf
sudo echo "SigLevel = Never" >> /etc/pacman.conf
sudo echo "Server = http://repo.archlinux.rf/$arch" >> /etc/pacman.conf
sudo pacman -Sy yaourt


## install Xwindow
sudo pacman -S xorg-server xorg-server-utils xorg-xinit xorg-xclock xterm


## install xfce4
sudo pacman -S xfce4 xfce4-goodies gamin


## automate xfce startup
echo "exec startxfce4" >> ~/.xinitrc


## install Graphic Driver
lspci | grep VGA
sudo pacman -Ss xf86-video    ## find your driver
sudo pacman -S xf86-video-instel


## Fonts
yaourt -S ttf-ricty
yaourt -S otf-takao oft-ipaexfont ttf-ipa-mona


## Display Manager (Login Manager)
sudo pacman -S slim archlinux-themes-slim slim-themes
sudo vim /etc/slim.conf
# login_cmd exec /usr/bin/zsh -l ~/.xinitrc %session
# daemon yes
# current_theme archlinux-simplyblack
# :wq!
sudo systemctl enable slim.service


## install Japanese
sudo pacman -S fcitx-im fcitx-mozc fcitx-configtool

vim .xinitrc
--
export GTK_IM_MODULE=fcitx
export QT_IM_MODULE=fcitx
export XMODIFIERS="@imi-fcitx"
--



## Apperrance
sudo yaourt -S numix-themes numix-circle-icon-theme-git

## reboot and login as ghasshee and go
## 1. Application menu > setting > Apperrance
## * style tab : Numix
## * icon tab : Numix Circle
## * font tab : Ritchy
## 2. Application menu > setting > windowManager
## * style tab's theme : Numix
## * style tab's title's font : Ritchy


## Sound
sudo pacman -S alsa-utils
sudo alsactl store


## Mouse Driver
sudo pacman -S xf86-input-synaptics
sudo pacman -S xf86-input-mouse


## supplement Thunar FileManager
sudo pacman -S thunar-volman thunar-media-tags-plugin thunar-archive-plugin file-roller
exo-preffered-application


## Dropbox with Thunar
yaourt -S thunar-dropbox dropbox


## 外部メディアやディスクの自動マウント
## SMBやFTPをnemo上でダブルクリックすると自動的にマウントしてくるツール
sudo pacman -S gvfs gvfs-afc gvfs-smb gvfs-afp gvfs-gphoto2 gvfs-mtp gvfs-goa


## SMBやFTPに接続する際に入力するユーザー名やパスワードを管理するツール
sudo pacman -S seahorse gnome-keyring


## oh my zsh
curl -L http://install.ohmyz.sh | sh
chsh -s /usr/bin/zsh
~~~

~~~
## etc

* chromium
* atom-editor
* ocular
* tmux
* guake (install & press F12 )
* vlc (play movies)
* ffmpeg
* launchy (command lancher)
* plank (App Dock like OSX)
* python-pip
* htop
* screenfetch (echo "screenfetch" >> .zshrc)
~~~


# base base-devel

~~~
acl-2.2.52-3
archlinux-keyring-20170104-1
attr-2.4.47-2
ca-certificates-20160507-1
ca-certificates-cacert-20140824-4
ca-certificates-mozilla-3.27.2-1
ca-certificates-utils-20160507-1
cracklib-2.9.6-1
curl-7.52.1-2
db-5.3.28-3
dbus-1.10.14-1
expat-2.2.0-2
gc-7.6.0-1
gdbm-1.12-2
glib2-2.50.2-1
gmp-6.1.2-1
gnupg-2.1.17-3
gnutls-3.4.17-1
gpgme-1.7.1-2
guile-2.0.13-2
hwids-20161103-1
iana-etc-20161101-1
icu-58.2-1
iptables-1.6.0-1
kbd-2.0.3-1
keyutils-1.5.9-1
kmod-23-1
krb5-1.13.7-1
libaio-0.3.110-1
libarchive-3.2.2-1
libassuan-2.4.3-1
libatomic_ops-7.4.4-1
libcap-2.25-1
libelf-0.168-1
libffi-3.2.1-2
libgcrypt-1.7.5-1
libgpg-error-1.26-1
libidn-1.33-1
libksba-1.3.4-2
libldap-2.4.44-2
libmnl-1.0.4-1
libmpc-1.0.3-2
libnftnl-1.0.7-1
libpipeline-1.4.1-1
libpsl-0.16.1-1
libsasl-2.1.26-8
libseccomp-2.3.1-1
libsecret-0.18.5-1
libssh2-1.8.0-1
libsystemd-232-6
libtasn1-4.9-2
libtirpc-1.0.1-2
libunistring-0.9.7-1
libusb-1.0.21-1
libutil-linux-2.28.2-2
linux-api-headers-4.7-1
linux-firmware-20161005.9c71af9-1
lz4-1:1.7.4.2-1
lzo-2.09-1
mkinitcpio-22-1
mkinitcpio-busybox-1.25.1-1
mpfr-3.1.5-1
ncurses-6.0+20161224-1
nettle-3.3-1
npth-1.3-1
openresolv-3.8.1-1
openssl-1.0.2.j-1
p11-kit-0.23.2-1
pacman-mirrorlist-20161214-1
pam-1.3.0-1
pambase-20130928-1
pcre-8.39-2
pinentry-1.0.0-1
popt-1.16-8
readline-7.0.001-1
sqlite-3.16.1-1
systemd-232-6
thin-provisioning-tools-0.6.3-1
tzdata-2016j-1
xz-5.2.3-1
zlib-1:1.2.8-7
autoconf-2.69-4
automake-1.15-2
bash-4.4.005-2
binutils-2.27-1
bison-3.0.4-2
bzip2-1.0.6-5
coreutils-8.26-1
cryptsetup-1.7.3-1
device-mapper-2.02.168-1
dhcpcd-6.11.5-1
diffutils-3.5-1
e2fsprogs-1.43.3-1
fakeroot-1.21-2
file-5.29-1
filesystem-2016.12-2
findutils-4.6.0-2
flex-2.6.1-1
gawk-4.1.4-2
gcc-6.2.1-1
gcc-libs-6.2.1-1
gettext-0.19.8.1-2
glibc-2.24-2
grep-2.27-1
groff-1.22.3-7
gzip-1.8-2
inetutils-1.9.4-5
iproute2-4.9.0-1
iputils-20161105.1f2bb12-1
jfsutils-1.1.15-4
less-487-1
libtool-2.4.6-6
licenses-20140629-1
linux-4.8.13-1
logrotate-3.11.0-1
lvm2-2.02.168-1
m4-1.4.17-2
make-4.2.1-1
man-db-2.7.6.1-2
man-pages-4.09-1
mdadm-3.4-1
nano-2.7.3-1
netctl-1.12-2
pacman-5.0.1-4
patch-2.7.5-1
pciutils-3.5.2-1
pcmciautils-018-7
perl-5.24.0-2
pkg-config-0.29.1-2
procps-ng-3.3.12-1
psmisc-22.21-3
reiserfsprogs-3.6.25-1
s-nail-14.8.14-1
sed-4.2.2-4
shadow-4.4-3
sudo-1.8.19.p1-1
sysfsutils-2.1.0-9
systemd-sysvcompat-232-6
tar-1.29-2
texinfo-6.3-1
usbutils-008-1
util-linux-2.28.2-2
vi-1:070224-2
which-2.21-2
xfsprogs-4.8.0-1

~~~




# networkmanager
mesa-libgl
~~~
adwaita-icon-theme-3.22.0-1
at-spi2-atk-2.22.0-1
at-spi2-core-2.22.0-1
atk-2.22+1+gd57f97d-1
avahi-0.6.32-2
cairo-1.14.8-1

compositeproto-0.4.2-3
damageproto-1.2.1-3
dbus-glib-0.108-1
dconf-0.26.0-2
desktop-file-utils-0.23-1
fixesproto-5.0-3

fontconfig-2.12.1-3
freetype2-2.7.1-1
gcr-3.20.0+11+g8322f27-1
gdk-pixbuf2-2.36.3-1
glib-networking-2.50.0-1
gpm-1.20.7-7

graphite-1:1.3.9-1
gsettings-desktop-schemas-3.22.0+1+g6f52ab5-1
gtk-update-icon-cache-3.22.6-1
gtk2-2.24.31-1
gtk3-3.22.6-1

harfbuzz-1.3.4-1
hicolor-icon-theme-0.15-1
inputproto-2.3.2-1
jansson-2.9-1
jasper-2.0.10-1
js17-17.0.0-4
json-glib-1.2.2+4+gd725fb5-1

kbproto-1.0.7-1
libcap-ng-0.7.8-1
libcroco-0.6.11-1
libcups-2.2.1-1
libdaemon-0.14-3
libdatrie-0.2.10-1
libdrm-2.4.74-1

libedit-20160903_3.1-1
libepoxy-1.3.1-1
libgudev-230-1
libice-1.0.9-1
libjpeg-turbo-1.5.1-1
libmm-glib-1.6.4-1
libndp-1.6-1

libnewt-0.52.19-1
libnm-glib-1.4.4-1
libnotify-0.7.7-1
libomxil-bellagio-0.9.3-1
libpciaccess-0.13.4-1
libpgm-5.2.122-2
libpng-1.6.27-1

libproxy-0.4.13-1
librsvg-2:2.40.16-1
libsm-1.2.2-2
libsodium-1.0.11-1
libsoup-2.56.0-1
libteam-1.23-1
libthai-0.1.25-1
libtiff-4.0.7-2

libtxc_dxtn-1.0.1-6

libx11-1.6.4-1
libxau-1.0.8-2
libxcb-1.12-1
libxcomposite-0.4.4-2
libxcursor-1.1.14-2
libxdamage-1.1.4-2

libxdmcp-1.1.2-1
libxext-1.3.3-1
libxfce4ui-4.12.1-2
libxfce4util-4.12.1-1
libxfixes-5.0.3-1
libxft-2.3.2-1
libxi-1.7.8-1

libxinerama-1.1.3-2
libxkbcommon-0.7.0-1
libxml2-2.9.4+12+ge905f08-2
libxrandr-1.5.1-1
libxrender-0.9.10-1
libxshmfence-1.2-1

libxtst-1.2.3-1
libxxf86vm-1.1.4-1
llvm-libs-3.9.1-2
mesa-13.0.2-2
mesa-libgl-13.0.2-2
nspr-4.13.1-1
nss-3.27.2-1
pango-1.40.3-1

pixman-0.34.0-1
polkit-0.113-4
randrproto-1.5.0-1
recordproto-1.14.2-2
renderproto-0.11.1-3
shared-mime-info-1.7-1
slang-2.3.1a-1

startup-notification-0.12-4
wayland-1.12.0-1
wayland-protocols-1.7-1
xcb-proto-1.12-2
xcb-util-0.4.0-1
xextproto
-7.3.0-1

xf86vidmodeproto-2.3.1-3
xfconf-4.12.1-1
xineramaproto-1.2.1-3
xkeyboard-config-2.19-1
xproto-7.0.31-1
zeromq-4.2.0-1

gnome-keyring-1:3.20.0+16+gbf8aa97-1
networkmanager-1.4.4-1
xfce4-notifyd-0.3.4-1
~~~
